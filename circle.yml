machine:
  pre:
    - wget https://storage.googleapis.com/golang/go1.5.1.linux-amd64.tar.gz
    - tar zxvf go1.5.1.linux-amd64.tar.gz
  environment:
    GOROOT: ${HOME}/go
    PATH: ${GOROOT}/bin:${PATH}
    GO15VENDOREXPERIMENT: 1
  post:
    - go version
test:
  pre:
    - go get golang.org/x/tools/cmd/cover
    - go get github.com/mattn/goveralls
  post:
    - go vet ./...
    # GOPATHが通っているディレクトリに移動してgocoverage_all.sh実行するサムシング
    # dependenciesのSetting up Go environmentで設定されるGOPATHです
    - sh ./circleci/test/override/gocoverage_all.sh:
        pwd: ../../../../../.go_project/src/github.com/kyokomi/$CIRCLE_PROJECT_REPONAME
    - goveralls -coverprofile=.profile.cov -service=circle-ci -repotoken $COVERALLS_TOKEN
